<div class="notes-editor">
    <app-loading-overlay *ngIf="loading"></app-loading-overlay>
    <div *ngIf="!loading">
        <div class="notes-toolbar">
            <!-- adding/sorting -->
            <mat-toolbar>
                <!-- <div class="toolbar-space"></div> -->
                <div class="controls button-list section">
                    <!-- TODO: implement toolbar button functionalities -->
                    <button mat-button class="control" matTooltip="add note" (click)="addNote()"><mat-icon aria-label="add">add</mat-icon></button>
                    <button mat-button class="control" matTooltip="sort by title" (click)="sortTitle()"><mat-icon aria-label="sortTitle">sort_by_alpha</mat-icon></button>
                    <button mat-button class="control" matTooltip="sort by modified date" (click)="sortDate()"><mat-icon aria-label="sortDate">calendar_today</mat-icon></button>
                    <!-- TODO: implement ability to search notes? -->
                    <mat-form-field>
                        <input matInput>
                        <mat-icon matSuffix>search</mat-icon>
                    </mat-form-field>
                </div>
            </mat-toolbar>
        </div>
        <div class="notes-content">
            <ng-container *ngFor="let note of notes">
                <mat-card class="sticky-note">
                    <mat-card-header>
                        <!-- title -->
                        <mat-form-field floatLabel="never" appearance="none">
                            <textarea matInput cdkTextareaAutosize 
                                #autosize="cdkTextareaAutosize"
                                [readonly]="!note.editing"
                                placeholder="{{note.editing ? 'Title' : ''}}"
                                [(ngModel)]="note.title"></textarea>
                        </mat-form-field>
                        <!-- note editor buttons -->
                        <button mat-button *ngIf="!note.editing" class="control" matTooltip="edit note" (click)="note.editing=true"><mat-icon aria-label="edit">edit</mat-icon></button>
                        <button mat-button *ngIf="note.editing" class="control" matTooltip="save note" (click)="saveNote(note)"><mat-icon aria-label="save">save</mat-icon></button>
                        <button mat-button class="control" matTooltip="delete note" (click)="deleteNote(note)"><mat-icon aria-label="delete">delete</mat-icon></button>
                    </mat-card-header>
                    <mat-card-content>
                        <markdown *ngIf="!note.editing" [data]="note.content"></markdown>
                        <mat-form-field *ngIf="note.editing" class="edit-note" floatLabel="never" appearance="none">
                            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" placeholder="Note" [(ngModel)]="note.content" required></textarea>
                        </mat-form-field>
                    </mat-card-content>
                </mat-card>
            </ng-container>
        </div>
        <app-empty-list-marker *ngIf="!notes.length" [checkAgain]="false"></app-empty-list-marker>
    </div>
</div>